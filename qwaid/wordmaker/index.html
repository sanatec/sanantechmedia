<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ÿßÿ±ÿØŸà Ÿàÿ±⁄à ŸÖ€å⁄©ÿ± ⁄Ø€åŸÖ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&display=swap');
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      font-family: 'Noto Nastaliq Urdu', serif;
      overflow-x: hidden;
    }
    
    body {
      background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 50%, #FECFEF 100%);
      background-size: 400% 400%;
      animation: gradientShift 8s ease infinite;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      min-height: 85vh;
      position: relative;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* Floating decorative elements */
    .decoration {
      position: absolute;
      pointer-events: none;
      opacity: 0.3;
      animation: float 6s ease-in-out infinite;
    }
    
    .decoration:nth-child(1) {
      top: 10%;
      left: 10%;
      font-size: 40px;
      animation-delay: 0s;
    }
    
    .decoration:nth-child(2) {
      top: 20%;
      right: 15%;
      font-size: 35px;
      animation-delay: 2s;
    }
    
    .decoration:nth-child(3) {
      bottom: 15%;
      left: 20%;
      font-size: 30px;
      animation-delay: 4s;
    }
    
    .decoration:nth-child(4) {
      bottom: 25%;
      right: 10%;
      font-size: 45px;
      animation-delay: 1s;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }
    
    .game-container {
      width: 100%;
      max-width: 800px;
      background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
      border-radius: 25px;
      padding: 25px;
      box-shadow: 
        0 20px 40px rgba(0,0,0,0.1),
        0 0 0 3px #FFD700,
        inset 0 0 20px rgba(255,215,0,0.1);
      position: relative;
      z-index: 10;
      border: 5px solid transparent;
      background-clip: padding-box;
    }
    
    .game-container::before {
      content: '';
      position: absolute;
      top: -5px;
      left: -5px;
      right: -5px;
      bottom: -5px;
      background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7);
      border-radius: 30px;
      z-index: -1;
      animation: borderGlow 3s ease-in-out infinite alternate;
    }
    
    @keyframes borderGlow {
      0% { opacity: 0.5; transform: scale(1); }
      100% { opacity: 1; transform: scale(1.01); }
    }
    
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 20px;
      border-radius: 20px;
      font-size: clamp(20px, 5vw, 28px);
      font-weight: 700;
      text-align: center;
      margin-bottom: 20px;
      font-family: 'Noto Nastaliq Urdu', serif;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
      position: relative;
      overflow: hidden;
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shine 2s infinite;
    }
    
    @keyframes shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    .level-selector {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 20px;
      padding: 15px;
      background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
      border-radius: 20px;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .level-btn {
      padding: 12px 18px;
      border-radius: 15px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, #74b9ff, #0984e3);
      color: white;
      font-weight: 700;
      font-size: clamp(12px, 2.5vw, 16px);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      font-family: 'Noto Nastaliq Urdu', serif;
      min-width: 90px;
      box-shadow: 0 4px 15px rgba(116, 185, 255, 0.4);
      position: relative;
      overflow: hidden;
    }
    
    .level-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transition: all 0.3s ease;
      transform: translate(-50%, -50%);
    }
    
    .level-btn:hover::before {
      width: 100%;
      height: 100%;
    }
    
    .level-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(116, 185, 255, 0.6);
    }
    
    .level-btn.active {
      background: linear-gradient(135deg, #fd79a8, #e84393);
      box-shadow: 0 8px 25px rgba(253, 121, 168, 0.5);
      transform: scale(1.1);
    }
    
    .level-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding: 15px 20px;
      background: linear-gradient(135deg, #a29bfe, #6c5ce7);
      color: #fff;
      border-radius: 15px;
      font-weight: 700;
      font-size: clamp(14px, 3vw, 18px);
      font-family: 'Noto Nastaliq Urdu', serif;
      flex-wrap: wrap;
      gap: 10px;
      box-shadow: 0 6px 20px rgba(108, 92, 231, 0.3);
    }
    
    .question-container {
      display: flex;
      justify-content: center;
      margin-bottom: 25px;
    }
    
    .question {
      font-size: clamp(28px, 7vw, 42px);
      padding: 25px 30px;
      border-radius: 20px;
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      border: 4px solid #ff7675;
      color: #2d3436;
      box-shadow: 
        0 10px 30px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.3);
      min-width: 220px;
      text-align: center;
      font-family: 'Noto Nastaliq Urdu', serif;
      font-weight: 800;
      position: relative;
      animation: questionPulse 2s ease-in-out infinite;
    }
    
    @keyframes questionPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    
    .options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-top: 25px;
    }
    
    .option {
      padding: 20px;
      border-radius: 18px;
      border: none;
      font-size: clamp(20px, 4.5vw, 28px);
      background: linear-gradient(135deg, #fd79a8, #fdcb6e);
      cursor: pointer;
      font-weight: 800;
      box-shadow: 0 8px 20px rgba(253, 121, 168, 0.3);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      font-family: 'Noto Nastaliq Urdu', serif;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #fff;
      position: relative;
      overflow: hidden;
    }
    
    .option::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .option:hover::before {
      left: 100%;
    }
    
    .option:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 35px rgba(253, 121, 168, 0.4);
    }
    
    .option:active {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 5px 15px rgba(253, 121, 168, 0.3);
    }
    
    .option:nth-child(1) { background: linear-gradient(135deg, #74b9ff, #0984e3); }
    .option:nth-child(2) { background: linear-gradient(135deg, #fd79a8, #e84393); }
    .option:nth-child(3) { background: linear-gradient(135deg, #fdcb6e, #e17055); }
    .option:nth-child(4) { background: linear-gradient(135deg, #6c5ce7, #a29bfe); }
    
    .feedback {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 300;
      background: linear-gradient(135deg, #ff7675, #fd79a8);
      color: white;
      padding: 25px 40px;
      border-radius: 20px;
      font-size: clamp(22px, 5vw, 36px);
      font-weight: 800;
      box-shadow: 0 20px 40px rgba(255, 118, 117, 0.4);
      display: none;
      border: 4px solid #ffffff;
      font-family: 'Noto Nastaliq Urdu', serif;
      text-align: center;
      max-width: 90vw;
      animation: feedbackBounce 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    @keyframes feedbackBounce {
      0% { transform: translate(-50%, -50%) scale(0); }
      50% { transform: translate(-50%, -50%) scale(1.1); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }
    
    canvas#star-canvas {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 200;
    }
    
    /* Success animation overlay */
    .success-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(116,185,255,0.3) 0%, transparent 70%);
      pointer-events: none;
      z-index: 250;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .success-overlay.active {
      opacity: 1;
    }
    
    /* Mobile responsive adjustments */
    @media (max-width: 768px) {
      .game-container {
        margin: 5px;
        padding: 18px;
        border-radius: 20px;
      }
      
      .level-selector {
        gap: 8px;
        padding: 12px;
      }
      
      .level-btn {
        padding: 10px 14px;
        min-width: 75px;
      }
      
      .level-info {
        flex-direction: column;
        text-align: center;
        gap: 8px;
        padding: 12px 16px;
      }
      
      .options {
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      
      .question {
        padding: 18px 20px;
        min-width: 180px;
      }
      
      .option {
        padding: 16px;
        min-height: 70px;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 5px;
      }
      
      .game-container {
        padding: 12px;
        border-radius: 15px;
        max-height: 90vh;
        overflow-y: auto;
      }
      
      header {
        padding: 10px;
        margin-bottom: 10px;
      }
      
      .level-selector {
        gap: 4px;
        padding: 8px;
        margin-bottom: 10px;
      }
      
      .level-btn {
        padding: 6px 10px;
        min-width: 60px;
        font-size: 11px;
      }
      
      .level-info {
        padding: 8px 10px;
        margin-bottom: 12px;
      }
      
      .question-container {
        margin-bottom: 12px;
      }
      
      .question {
        padding: 12px 15px;
        margin-bottom: 0;
      }
      
      .options {
        grid-template-columns: 1fr;
        gap: 8px;
        margin-top: 12px;
      }
      
      .option {
        padding: 12px;
        min-height: 50px;
      }
      
      .feedback {
        padding: 15px 25px;
        max-width: 95vw;
      }
      
      .decoration {
        display: none;
      }
    }
    
    @media (max-width: 320px) {
      .level-selector {
        flex-direction: column;
        align-items: center;
      }
      
      .level-btn {
        width: 100%;
        max-width: 200px;
      }
    }
    
    /* Ensure proper font rendering for all Urdu text elements */
    .question, .option, .feedback, .level-info, header, .level-btn {
      font-feature-settings: "liga" 1, "kern" 1;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* High DPI display adjustments */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .question, .option, .feedback, .level-info, header {
        -webkit-font-smoothing: subpixel-antialiased;
      }
    }
    
    /* Prevent text selection on game elements */
    .level-btn, .option, .question {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
  </style>
</head>
<body>
  <!-- Floating decorative elements -->
  <div class="decoration">üåü</div>
  <div class="decoration">‚≠ê</div>
  <div class="decoration">üéà</div>
  <div class="decoration">ü¶ã</div>

  <div class="game-container" role="application" aria-label="Urdu word maker game">
    <header>‚ú® Word Maker Game ‚ú®</header>

    <div class="level-selector" id="level-selector">
      <button class="level-btn level1 active" onclick="changeLevel(0)">Level 1</button>
      <button class="level-btn level2" onclick="changeLevel(1)">Level 2</button>
      <button class="level-btn level3" onclick="changeLevel(2)">Level 3</button>
      <button class="level-btn level4" onclick="changeLevel(3)">Level 4</button>
      <button class="level-btn level5" onclick="changeLevel(4)">Level 5</button>
    </div>

    <div class="level-info">
      <div id="level-display">Level 1 - ÿ®ŸÜ€åÿßÿØ€å ÿ≠ÿ±ŸàŸÅ</div>
      <div>Score: <span id="score">0</span> üèÜ</div>
    </div>

    <div class="question-container">
      <div class="question" id="question">---</div>
    </div>

    <div class="options" id="options" role="list"></div>

    <div class="feedback" id="feedback" role="status" aria-live="polite"></div>
    <div class="success-overlay" id="success-overlay"></div>
  </div>

  <canvas id="star-canvas" aria-hidden="true"></canvas>

  <script>
    // ---------- Enhanced Fireworks ----------
    const canvas = document.getElementById('star-canvas');
    const ctx = canvas.getContext('2d');
    const successOverlay = document.getElementById('success-overlay');

    function resizeCanvas(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function launchFireworks() {
      // Show success overlay
      successOverlay.classList.add('active');
      setTimeout(() => {
        successOverlay.classList.remove('active');
      }, 1000);

      const particles = [];
      const colors = ["#FFD700", "#FF6B6B", "#4ECDC4", "#45B7D1", "#96CEB4", "#FFEAA7", "#fd79a8", "#74b9ff"];

      // Create multiple explosion centers
      const centers = [
        { x: canvas.width * 0.3, y: canvas.height * 0.4 },
        { x: canvas.width * 0.7, y: canvas.height * 0.4 },
        { x: canvas.width * 0.5, y: canvas.height * 0.6 }
      ];

      centers.forEach(center => {
        for (let i = 0; i < 25; i++) {
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 8 + 4;
          particles.push({
            x: center.x,
            y: center.y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed - 3,
            size: Math.random() * 6 + 3,
            color: colors[Math.floor(Math.random() * colors.length)],
            life: 120,
            maxLife: 120
          });
        }
      });

      function drawStar(x, y, size, color, alpha) {
        ctx.save();
        ctx.globalAlpha = alpha;
        ctx.beginPath();
        ctx.translate(x, y);
        ctx.moveTo(0, -size);
        for (let i = 0; i < 5; i++) {
          ctx.rotate(Math.PI / 5);
          ctx.lineTo(0, -size * 0.5);
          ctx.rotate(Math.PI / 5);
          ctx.lineTo(0, -size);
        }
        ctx.closePath();
        ctx.fillStyle = color;
        ctx.shadowColor = color;
        ctx.shadowBlur = 20;
        ctx.fill();
        ctx.restore();
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach((p, i) => {
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.1; // gravity
          p.vx *= 0.99; // air resistance
          p.life--;
          
          if (p.life > 0) {
            const alpha = p.life / p.maxLife;
            drawStar(p.x, p.y, p.size * alpha, p.color, alpha);
          } else {
            particles.splice(i, 1);
          }
        });
        
        if (particles.length > 0) {
          requestAnimationFrame(animate);
        } else {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }
      animate();
    }

    // ---------- Levels data ----------
    const levels = [
      {
        name: "Level 1 - ÿ®ŸÜ€åÿßÿØ€å ÿ≠ÿ±ŸàŸÅ",
        puzzles: [
          { q: "⁄© + ÿß = ÿü", answer: "⁄©ÿß", choices: ["⁄©€å","⁄©ÿß","⁄©Ÿà","⁄©€Å"], audio: "ka.wav" },
          { q: "ÿ® + €å = ÿü", answer: "ÿ®€å", choices: ["ÿ®Ÿà","ÿ®€å","ÿ®ÿß","ÿ®€í"], audio: "bi.wav" },
          { q: "ÿ™ + Ÿà = ÿü", answer: "ÿ™Ÿà", choices: ["ÿ™€å","ÿ™ÿß","ÿ™Ÿà","ÿ™€Å"], audio: "to.wav" },
          { q: "ÿß + ÿß = ÿü", answer: "ÿ¢", choices:  ["ÿ¢","ÿßŸà","ÿß€å","ÿ¶€í"], audio: "aa.wav" },
          { q: "⁄© + €í = ÿü", answer: "⁄©€í", choices: ["⁄©€í","⁄©Ÿà","⁄©€å","⁄©ÿß"], audio: "ke.wav" },
          { q: "ÿ± + ÿß = ÿü", answer: "ÿ±ÿß", choices: ["ÿ±€í","ÿ±Ÿà","ÿ±€å","ÿ±ÿß"], audio: "ra.wav" },
          { q: "Ÿæ + ÿß = ÿü", answer: "Ÿæÿß", choices: ["Ÿæ€í","ŸæŸà","Ÿæ€å","Ÿæÿß"], audio: "pa.wav" },
          { q: "Ÿæ + €å = ÿü", answer: "Ÿæ€å", choices: ["Ÿæ€í","ŸæŸà","Ÿæ€å","Ÿæÿß"], audio: "pi.wav" },
          { q: "Ÿæ + Ÿà = ÿü", answer: "ŸæŸà", choices: ["Ÿæ€í","ŸæŸà","Ÿæ€å","Ÿæÿß"], audio: "po.wav" },
          { q: "Ÿæ + €í = ÿü", answer: "Ÿæ€í", choices: ["Ÿæ€í","ŸæŸà","Ÿæ€å","Ÿæÿß"], audio: "pe.wav" },
          { q: "Ÿπ + ÿß = ÿü", answer: "Ÿπÿß", choices: ["Ÿπ€í","ŸπŸà","Ÿπ€å","Ÿπÿß"], audio: "ta.wav" },
          { q: "Ÿπ + €å = ÿü", answer: "Ÿπ€å", choices: ["Ÿπ€í","ŸπŸà","Ÿπ€å","Ÿπÿß"], audio: "ti.wav" },
          { q: "Ÿπ + Ÿà = ÿü", answer: "ŸπŸà", choices: ["Ÿπ€í","ŸπŸà","Ÿπ€å","Ÿπÿß"], audio: "tto.wav" },
          { q: "Ÿπ + €í = ÿü", answer: "Ÿπ€í", choices: ["Ÿπ€í","ŸπŸà","Ÿπ€å","Ÿπÿß"], audio: "te.wav" },
          { q: "⁄Ü + ÿß = ÿü", answer: "⁄Üÿß", choices: ["⁄Ü€í","⁄ÜŸà","⁄Ü€å","⁄Üÿß"], audio: "cha.wav" },
          { q: "⁄Ü + €å = ÿü", answer: "⁄Ü€å", choices: ["⁄Ü€í","⁄ÜŸà","⁄Ü€å","⁄Üÿß"], audio: "chi.wav" },
          { q: "⁄Ü + Ÿà = ÿü", answer: "⁄ÜŸà", choices: ["⁄Ü€í","⁄ÜŸà","⁄Ü€å","⁄Üÿß"], audio: "chu.wav" },
          { q: "⁄Ü + €í = ÿü", answer: "⁄Ü€í", choices: ["⁄Ü€í","⁄ÜŸà","⁄Ü€å","⁄Üÿß"], audio: "che.wav" },
          { q: "ÿ≥ + ÿß = ÿü", answer: "ÿ≥ÿß", choices: ["ÿ≥€í","ÿ≥Ÿà","ÿ≥€å","ÿ≥ÿß"], audio: "sa.wav" },
          { q: "ÿ≥ + €å = ÿü", answer: "ÿ≥€å", choices: ["ÿ≥€í","ÿ≥Ÿà","ÿ≥€å","ÿ≥ÿß"], audio: "si.wav" },
          { q: "ÿ≥ + Ÿà = ÿü", answer: "ÿ≥Ÿà", choices: ["ÿ≥€í","ÿ≥Ÿà","ÿ≥€å","ÿ≥ÿß"], audio: "su.wav" },
          { q: "ÿ≥ + €í = ÿü", answer: "ÿ≥€í", choices: ["ÿ≥€í","ÿ≥Ÿà","ÿ≥€å","ÿ≥ÿß"], audio: "se.wav" },
          { q: "ŸÑ + ÿß = ÿü", answer: "ŸÑÿß", choices:  ["ŸÑ€í","ŸÑŸà","ŸÑ€å","ŸÑÿß"], audio: "la.wav" },
          { q: "ŸÑ + €å = ÿü", answer: "ŸÑ€å", choices: ["ŸÑ€í","ŸÑŸà","ŸÑ€å","ŸÑÿß"], audio: "li.wav" },
          { q: "ŸÑ + Ÿà = ÿü", answer: "ŸÑŸà", choices: ["ŸÑ€í","ŸÑŸà","ŸÑ€å","ŸÑÿß"], audio: "lu.wav" },
          { q: "ŸÑ + €í = ÿü", answer: "ŸÑ€í", choices: ["ŸÑ€í","ŸÑŸà","ŸÑ€å","ŸÑÿß"], audio: "le.wav" },
          { q: "ŸÅ + ÿß = ÿü", answer: "ŸÅÿß", choices: ["ŸÅ€í","ŸÅŸà","ŸÅ€å","ŸÅÿß"], audio: "fa.wav" },
          { q: "ŸÅ + €å = ÿü", answer: "ŸÅ€å", choices: ["ŸÅ€í","ŸÅŸà","ŸÅ€å","ŸÅÿß"], audio: "fi.wav" },
          { q: "ŸÅ + Ÿà = ÿü", answer: "ŸÅŸà", choices: ["ŸÅ€í","ŸÅŸà","ŸÅ€å","ŸÅÿß"], audio: "fu.wav" },
          { q: "ŸÅ + €í = ÿü", answer: "ŸÅ€í", choices: ["ŸÅ€í","ŸÅŸà","ŸÅ€å","ŸÅÿß"], audio: "fe.wav" },
          { q: "ŸÖ + ÿß = ÿü", answer: "ŸÖÿß", choices: ["ŸÖ€í","ŸÖŸà","ŸÖ€å","ŸÖÿß"], audio: "ma.wav" },
          { q: "ŸÖ + €å = ÿü", answer: "ŸÖ€å", choices: ["ŸÖ€í","ŸÖŸà","ŸÖ€å","ŸÖÿß"], audio: "mi.wav" },
          { q: "ŸÖ + Ÿà = ÿü", answer: "ŸÖŸà", choices: ["ŸÖ€í","ŸÖŸà","ŸÖ€å","ŸÖÿß"], audio: "mu.wav" },
          { q: "ŸÖ + €í = ÿü", answer: "ŸÖ€í", choices: ["ŸÖ€í","ŸÖŸà","ŸÖ€å","ŸÖÿß"], audio: "me.wav" },
          { q: "⁄Ø + Ÿà = ÿü", answer: "⁄ØŸà", choices: ["⁄Øÿß","⁄ØŸà","⁄Ø€å","⁄Ø€í"], audio: "go.wav" }
        ]
      },
      {
        name: "Level 2 - ÿ™€åŸÜ ÿ≠ÿ±ŸàŸÅ",
        puzzles: [
          { q: "ÿ® + ÿß + ŸÑ = ÿü", answer: "ÿ®ÿßŸÑ", choices: ["ÿ®ÿßŸÑ","ÿ®ÿßÿ±","ÿ®ÿßÿ≤","ÿ®ÿßŸÖ"], audio: "baal.wav" },
          { q: "⁄Ø + ⁄æ + ÿ± = ÿü", answer: "⁄Ø⁄æÿ±", choices: ["⁄Ø⁄æÿ±","⁄Ø€Åÿ±","⁄Øÿßÿ±","⁄Ø€åÿ±"], audio: "ghar.wav" },
          { q: "⁄© + ÿß + ŸÖ = ÿü", answer: "⁄©ÿßŸÖ", choices: ["⁄©ÿßŸÖ","⁄©ÿßŸÑ","⁄©ÿßÿ±","⁄©ÿßŸæ"], audio: "kaam.wav" },
          { q: "Ÿæ + ÿß + ŸÜ = ÿü", answer: "ŸæÿßŸÜ", choices: ["ŸæÿßŸÜ","ŸæÿßŸÑ","Ÿæÿßÿ±","Ÿæÿß⁄©"], audio: "paan.wav" },
          { q: "⁄Ü + ÿß + ÿ± = ÿü", answer: "⁄Üÿßÿ±", choices: ["⁄Üÿßÿ±","⁄ÜÿßŸÑ","⁄ÜÿßŸæ","⁄Üÿß⁄©"], audio: "chaar.wav" },
          { q: "ÿØ + Ÿà + ÿ± = ÿü", answer: "ÿØŸàÿ±", choices: ["ÿØŸàÿ±","ÿØÿßŸÑ","ÿØÿßÿ±","ÿØÿßÿ∫"], audio: "door.wav" },
          { q: "ŸÜ + ÿß + ŸÖ = ÿü", answer: "ŸÜÿßŸÖ", choices: ["ŸÜÿßŸÖ","ŸÜÿßŸÑ","ŸÜÿßÿ±","ŸÜÿß⁄©"], audio: "naam.wav" },
          { q: "ÿ± + ÿß + ÿ™ = ÿü", answer: "ÿ±ÿßÿ™", choices: ["ÿ±ÿßÿ™","ÿ±ÿßÿ≤","ÿ±ÿß€Å","ÿ±ÿßŸÖ"], audio: "raat.wav" },
          { q: "ÿØ + ÿß + ŸÑ = ÿü", answer: "ÿØÿßŸÑ", choices: ["ÿØÿßŸÑ","ÿØÿßÿ±","ÿØÿßŸÖ","ÿØÿßÿ∫"], audio: "daal.wav" },
          { q: "ÿ¢ + ⁄Ø = ÿü", answer: "ÿ¢⁄Ø", choices: ["ÿ¢⁄Ø","ÿ¢Ÿæ","ÿ¢ŸÖ","ÿ¢ÿ¨"], audio: "aag.wav" },
          { q: "ÿ® + ÿß + ÿ∫ = ÿü", answer: "ÿ®ÿßÿ∫", choices: ["ÿ®ÿßÿ∫","ÿ®ÿßÿ±","ÿ®ÿßÿ≤","ÿ®ÿßŸÖ"], audio: "baagh.wav" },
          { q: "ŸÖ + ÿß + ⁄∫ = ÿü", answer: "ŸÖÿß⁄∫", choices: ["ŸÖÿß⁄∫","ŸÖÿßŸÜ","ŸÖÿßŸÑ","ŸÖÿßÿ±"], audio: "maan.wav" }
        ]
      },
      {
        name: "Level 3 - ⁄Üÿßÿ± ÿ≠ÿ±ŸàŸÅ",
        puzzles: [
          { q: "⁄© + ÿ™ + ÿß + ÿ® = ÿü", answer: "⁄©ÿ™ÿßÿ®", choices: ["⁄©ÿ™ÿßÿ®","⁄©ŸÖÿßŸÑ","⁄©ŸÑÿßŸÖ","⁄©ŸÖÿßŸÜ"], audio: "kitaab.wav" },
          { q: "Ÿæ + ÿß + ŸÜ + €å = ÿü", answer: "ŸæÿßŸÜ€å", choices: ["ŸæÿßŸÜ€å","ŸæÿßŸÑ⁄©","Ÿæÿßÿ±⁄©","Ÿæÿß⁄©€å"], audio: "paani.wav" },
          { q: "ÿ¢ + ÿØ + ŸÖ + €å = ÿü", answer: "ÿ¢ÿØŸÖ€å", choices: ["ÿ¢ÿØŸÖ€å","ÿ¢ÿ±ÿßŸÖ","ÿ¢Ÿàÿßÿ≤","ÿ¢ŸÜ⁄©⁄æ"], audio: "aadmi.wav" },
          { q: "ÿ≥ + ÿ® + ÿ≤ + €å = ÿü", answer: "ÿ≥ÿ®ÿ≤€å", choices: ["ÿ≥ÿ®ÿ≤€å","ÿ≥ÿ±ÿØ€å","ÿ≥ÿßŸÑ€å","ÿ≥ŸÖÿ¨⁄æ"], audio: "sabzi.wav" },
          { q: "ŸÖ + ⁄© + ÿß + ŸÜ = ÿü", answer: "ŸÖ⁄©ÿßŸÜ", choices: ["ŸÖ⁄©ÿßŸÜ","ŸÖ€ÅÿßŸÜ","ŸÖŸÑÿßŸÜ","ŸÖÿØÿßŸÜ"], audio: "makaan.wav" },
          { q: "ÿØ + Ÿà + ÿ≥ + ÿ™ = ÿü", answer: "ÿØŸàÿ≥ÿ™", choices: ["ÿØŸàÿ≥ÿ™","ÿØÿ±ÿ≥ÿ™","ÿØŸàŸÑÿ™","ÿØŸÜ€åÿß"], audio: "dost.wav" },
          { q: "Ÿæ + ⁄æ + Ÿà + ŸÑ = ÿü", answer: "Ÿæ⁄æŸàŸÑ", choices: ["Ÿæ⁄æŸàŸÑ","Ÿæ€ÅŸàŸÑ","ŸæŸÑŸàŸÑ","Ÿæ⁄©ŸàŸÑ"], audio: "phool.wav" },
          { q: "⁄Ü + ÿß + ŸÜ + ÿØ = ÿü", answer: "⁄ÜÿßŸÜÿØ", choices: ["⁄ÜÿßŸÜÿØ","⁄ÜÿßŸÑÿØ","⁄Üÿßÿ±ÿØ","⁄Üÿß⁄©ÿØ"], audio: "chaand.wav" },
          { q: "Ÿæ + ÿ± + ŸÜ + ÿØ = ÿü", answer: "Ÿæÿ±ŸÜÿØ", choices: ["Ÿæÿ±ŸÜÿØ","ŸæŸÑŸÜÿØ","Ÿæ⁄©ŸÜÿØ","Ÿæ€ÅŸÜÿØ"], audio: "parind.wav" },
          { q: "ÿ≥ + Ÿà + ÿ± + ÿ¨ = ÿü", answer: "ÿ≥Ÿàÿ±ÿ¨", choices: ["ÿ≥Ÿàÿ±ÿ¨","ÿ≥ÿßŸÑÿ¨","ÿ≥ÿßÿ±ÿ¨","ÿ≥€åÿ±ÿ¨"], audio: "suraj.wav" },
          { q: "ŸÖ + ⁄Ü + ⁄æ + ÿ± = ÿü", answer: "ŸÖ⁄Ü⁄æÿ±", choices: ["ŸÖ⁄Ü⁄æÿ±","ŸÖÿ≠⁄æÿ±","ŸÖŸÑ⁄æÿ±","ŸÖ⁄©⁄æÿ±"], audio: "machar.wav" },
          { q: "ÿ® + ⁄Ü + ⁄æ + ÿß = ÿü", answer: "ÿ®⁄Ü⁄æÿß", choices: ["ÿ®⁄Ü⁄æÿß","ÿ®ŸÑ⁄æÿß","ÿ®⁄©⁄æÿß","ÿ®€Å⁄æÿß"], audio: "bachha.wav" }
        ]
      },
      {
        name: "Level 4 - ŸæÿßŸÜ⁄Ü ÿ≠ÿ±ŸàŸÅ",
        puzzles: [
          { q: "ÿ™ + ÿπ + ŸÑ + €å + ŸÖ = ÿü", answer: "ÿ™ÿπŸÑ€åŸÖ", choices: ["ÿ™ÿπŸÑ€åŸÖ","ÿ™⁄©ŸÑ€åŸÖ","ÿ™ÿ≥ŸÑ€åŸÖ","ÿ™ÿ≠ŸÑ€åŸÖ"], audio: "taleem.wav" },
          { q: "ŸÖ + ÿ® + ÿß + ÿ± + ⁄© = ÿü", answer: "ŸÖÿ®ÿßÿ±⁄©", choices: ["ŸÖÿ®ÿßÿ±⁄©","ŸÖÿßÿ®ÿ±⁄©","ŸÖÿ®ÿ±ÿß⁄©","ŸÖÿ®ÿß⁄©ÿ±"], audio: "mohabbat.wav" },
          { q: "ÿß + ŸÜ + ÿ≥ + ÿß + ŸÜ = ÿü", answer: "ÿßŸÜÿ≥ÿßŸÜ", choices: ["ÿßŸÜÿ≥ÿßŸÜ","ÿß€Åÿ≥ÿßŸÜ","ÿßŸÖÿ≥ÿßŸÜ","ÿßŸÑÿ¥ÿßŸÜ"], audio: "insaan.wav" },
          { q: "ŸÖ + ÿØ + ÿ± + ÿ≥ + €Å = ÿü", answer: "ŸÖÿØÿ±ÿ≥€Å", choices: ["ŸÖÿØÿ±ÿ≥€Å","ŸÖ€Åÿ±ÿ≥€Å","ŸÖŸÑÿ±ÿ≥€Å","ŸÖÿ±ÿ±ÿ≥€Å"], audio: "madrasa.wav" },
          { q: "ÿÆ + Ÿà + ÿ¥ + €å = ÿü", answer: "ÿÆŸàÿ¥€å", choices: ["ÿÆŸàÿ¥€å","ÿÆÿ±ÿ¥€å","ÿÆ€åÿ¥€å","ÿÆÿßÿ¥€å"], audio: "khushi.wav" },
          { q: "ŸÖ + ÿ¥ + ⁄© + ŸÑ = ÿü", answer: "ŸÖÿ¥⁄©ŸÑ", choices: ["ŸÖÿ¥⁄©ŸÑ","ŸÖ€Å⁄©ŸÑ","ŸÖŸÑ⁄©ŸÑ","ŸÖÿ±⁄©ŸÑ"], audio: "mushkil.wav" },
          { q: "ÿ™ + ÿß + ÿ± + €å + ÿÆ = ÿü", answer: "ÿ™ÿßÿ±€åÿÆ", choices: ["ÿ™ÿßÿ±€åÿÆ","ÿ™€Åÿ±€åÿÆ","ÿ™€åÿ±€åÿÆ","ÿ™ÿß⁄æ€åÿÆ"], audio: "tareekh.wav" },
          { q: "ŸÖ + ŸÇ + ÿß + ŸÑ + €Å = ÿü", answer: "ŸÖŸÇÿßŸÑ€Å", choices: ["ŸÖŸÇÿßŸÑ€Å","ŸÖ€ÅÿßŸÑ€Å","ŸÖ€åÿßŸÑ€Å","ŸÖÿ±ÿßŸÑ€Å"], audio: "maqala.wav" },
          { q: "ÿ≠ + ÿß + ŸÑ + ÿß + ÿ™ = ÿü", answer: "ÿ≠ÿßŸÑÿßÿ™", choices: ["ÿ≠ÿßŸÑÿßÿ™","€ÅÿßŸÑÿßÿ™","ÿÆÿßŸÑÿßÿ™","ÿ¨ÿßŸÑÿßÿ™"], audio: "haalaat.wav" },
          { q: "ŸÖ + ÿ≥ + ÿß + ÿ¶ + ŸÑ = ÿü", answer: "ŸÖÿ≥ÿßÿ¶ŸÑ", choices: ["ŸÖÿ≥ÿßÿ¶ŸÑ","ŸÖ€Åÿßÿ¶ŸÑ","ŸÖ€åÿßÿ¶ŸÑ","ŸÖÿ±ÿßÿ¶ŸÑ"], audio: "masail.wav" }
        ]
      },
      {
        name: "Level 5 - ⁄Ü⁄æ ÿ≠ÿ±ŸàŸÅ",
        puzzles: [
          { q: "ÿ™ + ÿ± + ÿ® + €å + ÿ™ = ÿü", answer: "ÿ™ÿ±ÿ®€åÿ™", choices: ["ÿ™ÿ±ÿ®€åÿ™","ÿ™ÿ±€Å€åÿ™","ÿ™ÿ±€åÿ®ÿ™","ÿ™ÿ±ÿ®€å€Å"], audio: "tarbiyat.wav" },
          { q: "ŸÖ + ÿÆ + ÿµ + Ÿà + ÿµ = ÿü", answer: "ŸÖÿÆÿµŸàÿµ", choices: ["ŸÖÿÆÿµŸàÿµ","ŸÖÿ≠ÿµŸàÿµ","ŸÖŸÑÿµŸàÿµ","ŸÖÿ±ÿµŸàÿµ"], audio: "makhsoos.wav" },
          { q: "ÿ≠ + ⁄© + Ÿà + ŸÖ + ÿ™ = ÿü", answer: "ÿ≠⁄©ŸàŸÖÿ™", choices: ["ÿ≠⁄©ŸàŸÖÿ™","ÿ≠€ÅŸàŸÖÿ™","ÿ≠ŸÑŸàŸÖÿ™","ÿ≠ÿ±ŸàŸÖÿ™"], audio: "hukumat.wav" },
          { q: "ÿ™ + ÿ¨ + ÿ± + ÿ® + €Å = ÿü", answer: "ÿ™ÿ¨ÿ±ÿ®€Å", choices: ["ÿ™ÿ¨ÿ±ÿ®€Å","ÿ™€Åÿ±ÿ®€Å","ÿ™ŸÑÿ±ÿ®€Å","ÿ™ÿ±ÿ±ÿ®€Å"], audio: "tajurba.wav" },
          { q: "ŸÖ + ÿπ + ÿß + ÿ¥ + ÿ± + €Å = ÿü", answer: "ŸÖÿπÿßÿ¥ÿ±€Å", choices: ["ŸÖÿπÿßÿ¥ÿ±€Å","ŸÖ€Åÿßÿ¥ÿ±€Å","ŸÖ€åÿßÿ¥ÿ±€Å","ŸÖÿ±ÿßÿ¥ÿ±€Å"], audio: "muashira.wav" },
          { q: "ÿß + ÿ≠ + ÿ™ + ÿ± + ÿß + ŸÖ = ÿü", answer: "ÿßÿ≠ÿ™ÿ±ÿßŸÖ", choices: ["ÿßÿ≠ÿ™ÿ±ÿßŸÖ","ÿß€Åÿ™ÿ±ÿßŸÖ","ÿß€åÿ™ÿ±ÿßŸÖ","ÿßÿ±ÿ™ÿ±ÿßŸÖ"], audio: "ehtram.wav" },
          { q: "ŸÖ + ŸÇ + ÿµ + ÿØ + €å + ÿ™ = ÿü", answer: "ŸÖŸÇÿµÿØ€åÿ™", choices: ["ŸÖŸÇÿµÿØ€åÿ™","ŸÖ€ÅÿµÿØ€åÿ™","ŸÖŸÑÿµÿØ€åÿ™","ŸÖÿ±ÿµÿØ€åÿ™"], audio: "maqsadiyat.wav" },
          { q: "ÿ¢ + ÿ≤ + ÿß + ÿØ + €å = ÿü", answer: "ÿ¢ÿ≤ÿßÿØ€å", choices: ["ÿ¢ÿ≤ÿßÿØ€å","ÿ¢€ÅÿßÿØ€å","ÿ¢ŸÑÿßÿØ€å","ÿ¢ÿ±ÿßÿØ€å"], audio: "azaadi.wav" },
          { q: "ŸÖ + €Å + ÿ± + ÿ® + ÿß + ŸÜ = ÿü", answer: "ŸÖ€Åÿ±ÿ®ÿßŸÜ", choices: ["ŸÖ€Åÿ±ÿ®ÿßŸÜ","ŸÖÿ≠ÿ±ÿ®ÿßŸÜ","ŸÖŸÑÿ±ÿ®ÿßŸÜ","ŸÖÿ±ÿ±ÿ®ÿßŸÜ"], audio: "mehrbaan.wav" },
          { q: "ÿß + ŸÜ + ÿ™ + ÿ∏ + ÿß + ÿ± = ÿü", answer: "ÿßŸÜÿ™ÿ∏ÿßÿ±", choices: ["ÿßŸÜÿ™ÿ∏ÿßÿ±","ÿß€Åÿ™ÿ∏ÿßÿ±","ÿß€åÿ™ÿ∏ÿßÿ±","ÿßÿ±ÿ™ÿ∏ÿßÿ±"], audio: "intezaar.wav" }
        ]
      }
    ];

    // ---------- Game state ----------
    let currentLevel = 0;
    let currentPuzzle = 0;
    let score = 0;

    // ---------- UI helpers ----------
    const questionEl = document.getElementById('question');
    const optionsEl = document.getElementById('options');
    const feedbackEl = document.getElementById('feedback');
    const levelDisplayEl = document.getElementById('level-display');
    const scoreEl = document.getElementById('score');

    function updateLevelButtons() {
      document.querySelectorAll('.level-btn').forEach((btn, idx) => {
        if (idx === currentLevel) btn.classList.add('active'); else btn.classList.remove('active');
      });
    }

    function changeLevel(levelIndex) {
      currentLevel = levelIndex;
      currentPuzzle = 0;
      updateLevelButtons();
      loadPuzzle();
      updateDisplay();
    }

    function updateDisplay() {
      levelDisplayEl.innerText = levels[currentLevel].name;
      scoreEl.innerText = score;
    }

    function loadPuzzle() {
      feedbackEl.style.display = 'none';
      const level = levels[currentLevel];
      if (!level || level.puzzles.length === 0) {
        questionEl.innerText = '⁄©Ÿàÿ¶€å Ÿæÿ≤ŸÑ ŸÖŸàÿ¨ŸàÿØ ŸÜ€Å€å⁄∫';
        optionsEl.innerHTML = '';
        return;
      }
      // ensure currentPuzzle within bounds
      if (currentPuzzle >= level.puzzles.length) currentPuzzle = 0;
      const puzzle = level.puzzles[currentPuzzle];
      questionEl.innerText = puzzle.q || '---';
      optionsEl.innerHTML = '';

      // shuffle choices
      const shuffled = [...puzzle.choices].sort(() => Math.random() - 0.5);
      shuffled.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.innerText = choice;
        btn.setAttribute('role','listitem');
        btn.onclick = () => checkAnswer(choice);
        optionsEl.appendChild(btn);
      });
    }

    function checkAnswer(choice) {
      const puzzle = levels[currentLevel].puzzles[currentPuzzle];
      if (!puzzle) return;
      if (choice === puzzle.answer) {
        // correct: update score, play audio (if file exists), launch fireworks, advance puzzle
        score += (currentLevel + 1) * 20;
        updateDisplay();

        // play audio if provided (silently fail if not found)
        if (puzzle.audio) {
          try {
            const audio = new Audio(puzzle.audio);
            audio.play().catch(()=>{});
          } catch (e) {}
        }

        // launch enhanced fireworks
        launchFireworks();

        // short pause so fireworks visible, then next puzzle
        setTimeout(() => {
          currentPuzzle++;
          if (currentPuzzle >= levels[currentLevel].puzzles.length) currentPuzzle = 0;
          loadPuzzle();
          updateDisplay();
        }, 2000);
      } else {
        // wrong: show feedback message briefly
        feedbackEl.innerText = "‚ùå ÿØŸàÿ®ÿßÿ±€Å ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±€å⁄∫!";
        feedbackEl.style.display = 'block';
        setTimeout(() => {
          feedbackEl.style.display = 'none';
        }, 1500);
      }
    }

    // initialize
    updateLevelButtons();
    updateDisplay();
    loadPuzzle();

    // keyboard accessibility: number keys 1-4 select option in order
    window.addEventListener('keydown', (e) => {
      const opts = Array.from(document.querySelectorAll('.option'));
      if (!opts.length) return;
      if (e.key >= '1' && e.key <= String(opts.length)) {
        const idx = Number(e.key) - 1;
        opts[idx].click();
      }
      // left/right to change levels
      if (e.key === 'ArrowLeft') changeLevel(Math.max(0, currentLevel-1));
      if (e.key === 'ArrowRight') changeLevel(Math.min(levels.length-1, currentLevel+1));
    });

    // Prevent zoom on double tap for better mobile experience
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);

    // Handle orientation change
    window.addEventListener('orientationchange', function() {
      setTimeout(resizeCanvas, 100);
    });

    // Improved touch handling - only for game container area, not level changes
    let gameContainer = document.querySelector('.game-container');
    let touchStartTime = 0;
    let touchStartX = 0;
    let touchStartY = 0;
    let isScrolling = false;

    gameContainer.addEventListener('touchstart', function(e) {
      touchStartTime = Date.now();
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
      isScrolling = false;
    }, { passive: true });

    gameContainer.addEventListener('touchmove', function(e) {
      if (!touchStartX || !touchStartY) return;
      
      let touchEndX = e.touches[0].clientX;
      let touchEndY = e.touches[0].clientY;
      let diffX = Math.abs(touchStartX - touchEndX);
      let diffY = Math.abs(touchStartY - touchEndY);
      
      // If significant vertical movement, consider it scrolling
      if (diffY > 10) {
        isScrolling = true;
      }
    }, { passive: true });

    // Remove swipe functionality to prevent accidental level changes
    gameContainer.addEventListener('touchend', function(e) {
      // Reset values
      touchStartTime = 0;
      touchStartX = 0;
      touchStartY = 0;
      isScrolling = false;
    }, { passive: true });
  </script>
</body>
</html>
